<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SP-Energy | Emisiones</title>
    <link rel="stylesheet" href="style.css" />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        .chart-wrapper { display: flex; flex-wrap: wrap; gap: 20px; align-items: center; margin-top: 1rem; }
        .chart-area { flex: 3; min-width: 300px; height: 400px; }
        .info-area { 
            flex: 1; min-width: 250px; background: #fff; padding: 20px; 
            border-radius: 8px; border-left: 5px solid #FFD700; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.05); 
        }
        .info-area h4 { margin-top: 0; color: #333; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .info-area p { font-size: 0.95rem; line-height: 1.5; color: #555; }
        .highlight { color: #d35400; font-weight: bold; }
        
        /* Estilo especial para la ecuación */
        .equation-box {
            background-color: #2c3e50;
            color: #fff;
            padding: 15px;
            border-radius: 5px;
            text-align: center;
            font-family: 'Courier New', Courier, monospace;
            margin-bottom: 20px;
            font-size: 1.1rem;
        }

        /* Referencias (Estilo Oscuro) */
        .references { background: #222; color: #eee; padding: 40px 20px; margin-top: 50px; font-size: 0.9rem; }
        .references h3 { color: #FFD700; margin-bottom: 20px; border-bottom: 1px solid #444; display: inline-block; }
        .references ul { list-style: none; padding: 0; }
        .references li { margin-bottom: 15px; line-height: 1.4; }
        .references a { color: #ddd; text-decoration: none; font-weight: bold; }
        .references a:hover { color: #FFD700; text-decoration: underline; }
    </style>
</head>
<body>

    <header class="main-header">
        <div class="logo-container"><span class="logo-text">SP-ENERGY <span class="sun-icon">☀️</span></span></div>
        <div class="slogan-container"><h1>Energía Solar para Todos</h1></div>
        <div class="spacer"></div> 
    </header>

    <nav class="navbar">
        <ul>
            <li><a href="index.html">Inicio</a></li>
            <li><a href="mapa.html">Mapa Interactivo</a></li>
            <li><a href="graficas.html">Gráficas y Tablas</a></li>
            <li><a href="emisiones.html" class="active">Emisiones</a></li>
            <li><a href="info.html">Contacto</a></li>
        </ul>
    </nav>

    <main class="main-container">
        <h2 class="section-title">Impacto Ambiental y Emisiones de GEI</h2>

        <section class="graph-card">
            <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap;">
                <h2>Factor de Emisión del SEN (tCO₂e/MWh)</h2>
                <div class="view-toggle">
                    <button id="btnFactorChart" class="btn primary">Ver gráfica</button>
                    <button id="btnFactorTable" class="btn">Ver tabla</button>
                </div>
            </div>
            <p>El Factor de Emisión Eléctrico representa la cantidad de gases de efecto invernadero emitidos por cada MWh de electricidad generado en el país.</p>

            <div id="factorChartContainer">
                <div class="chart-wrapper">
                    <div class="chart-area"><canvas id="chartFactor"></canvas></div>
                    <div class="info-area">
                        <h4>Tendencia del Factor</h4>
                        <p>El factor de emisión oscila dependiendo de la mezcla de combustibles fósiles y renovables. En 2024, se estima un valor de <span class="highlight" id="valFactor24"></span> tCO₂e/MWh.</p>
                    </div>
                </div>
            </div>

            <div id="factorTableContainer" style="display:none; overflow-x:auto;">
                <table class="data-table">
                    <thead><tr><th>Año</th><th>Factor de Emisión (tCO₂e/MWh)</th></tr></thead>
                    <tbody id="factorTableBody"></tbody>
                </table>
            </div>
        </section>

        <section class="graph-card">
            <h2>Emisiones Totales Asociadas a la Generación</h2>
            
            <div class="equation-box">
                

[Image of Formula for Emissions Calculation]
 
                Emisiones (tCO₂e) = Consumo Bruto (MWh) × Factor de Emisión (tCO₂e/MWh)
            </div>

            <div class="chart-wrapper">
                <div class="chart-area"><canvas id="chartEmissions"></canvas></div>
                <div class="info-area" id="emissionsInfo">
                    <h4>Evolución al 2024</h4>
                    </div>
            </div>
        </section>

        <section class="graph-card" style="border-top: 5px solid #27ae60;">
            <h2>Impacto Positivo: Emisiones Evitadas por Energía Solar</h2>
            <p>Estimación de las toneladas de CO₂ equivalente que se dejaron de emitir a la atmósfera gracias a la generación solar fotovoltaica en el SEN.</p>
            
            <div class="chart-wrapper">
                <div class="chart-area"><canvas id="chartAvoided"></canvas></div>
                <div class="info-area">
                    <h4>Contribución Solar</h4>
                    <p>Gracias a la generación fotovoltaica en 2024, se evitaron aproximadamente <span class="highlight" id="valAvoided24"></span> millones de toneladas de CO₂e.</p>
                    <p style="margin-top:10px; font-size:0.85rem; color:#777;">*Cálculo: Generación Solar (MWh) × Factor de Emisión del año correspondiente.</p>
                </div>
            </div>
        </section>

    </main>

    <div class="references">
        <div style="max-width: 1200px; margin: 0 auto;">
            <h3>Referencias Bibliográficas</h3>
            <ul>
                <li>Centro Nacional de Control de Energía (CENACE) <a href="https://www.cenace.gob.mx/Paginas/SIM/Reportes/EnergiaGeneradaTipoTec.aspx" target="_blank">https://www.cenace.gob.mx/Paginas/SIM/Reportes/EnergiaGeneradaTipoTec.aspx</a></li>
                <li>Plan de Desarrollo del Sector Eléctrico (PDSE)</li>
                <li>Programa de Desarrollo del Sistema Eléctrico Nacional (PRODESEN) <a href="https://www.cenace.gob.mx/Docs/16_MARCOREGULATORIO/Prodecen/20%202024-2038%20Cap%C3%ADtulos%201%20al%206.pdf" target="_blank">https://www.cenace.gob.mx/Docs/16_MARCOREGULATORIO/Prodecen/20%202024-2038%20Cap%C3%ADtulos%201%20al%206.pdf</a></li>
                <li>Sistema de Información Energética (SIE) <a href="https://sie.energia.gob.mx/inicio/" target="_blank">https://sie.energia.gob.mx/inicio/</a></li>
            </ul>
        </div>
    </div>

    <footer><p>&copy; 2025 SP-Energy.</p></footer>

    <script>
        // 1. DATOS
        const years = [2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024];
        
        // Consumo Bruto (GWh) - Importado de tus datos anteriores
        const consumoBrutoSen = [253460,269831,275033,275497,280161,288224,298792,309726,318233,324921,315969,329032,340613,351584,359807];
        
        // Generación Solar (GWh)
        const genSolar = [0,0,3,20,83,45,151,349,2176,8394,13528,17069,16290,18210,18640];

        // Factor de Emisión Estimado (tCO2e/MWh) - Basado en tendencia histórica MX
        const factorEmision = [0.485, 0.490, 0.495, 0.502, 0.485, 0.465, 0.458, 0.496, 0.510, 0.490, 0.475, 0.465, 0.455, 0.432, 0.425];

        // CÁLCULOS MATEMÁTICOS
        // 1. Emisiones Totales (Millones de Toneladas)
        // Formula: GWh * 1000 = MWh.  MWh * Factor = Toneladas.  / 1,000,000 = Millones de Toneladas
        const emisionesTotales = consumoBrutoSen.map((cons, i) => {
            return (cons * 1000 * factorEmision[i]) / 1000000; 
        });

        // 2. Emisiones Evitadas (Millones de Toneladas)
        const emisionesEvitadas = genSolar.map((gen, i) => {
            return (gen * 1000 * factorEmision[i]) / 1000000;
        });

        // --- GENERACIÓN DE GRÁFICAS ---

        // A. Gráfica Factor de Emisión
        function initFactorChart() {
            const ctx = document.getElementById('chartFactor');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: years,
                    datasets: [{
                        label: 'Factor de Emisión (tCO₂e/MWh)',
                        data: factorEmision,
                        borderColor: '#e67e22', // Naranja óxido
                        backgroundColor: 'rgba(230, 126, 34, 0.2)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.3,
                        pointRadius: 4,
                        pointHitRadius: 20
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: { mode: 'nearest', intersect: true },
                    plugins: { legend: { display: false } },
                    scales: { y: { title: { display: true, text: 'tCO₂e / MWh' } } }
                }
            });

            // Llenar tabla
            const tbody = document.getElementById('factorTableBody');
            years.forEach((y, i) => {
                tbody.innerHTML += `<tr><td>${y}</td><td>${factorEmision[i].toFixed(3)}</td></tr>`;
            });
            // Dato 2024 en texto
            document.getElementById('valFactor24').innerText = factorEmision[factorEmision.length-1].toFixed(3);
        }

        // B. Gráfica Emisiones Totales
        function initEmissionsChart() {
            const ctx = document.getElementById('chartEmissions');
            new Chart(ctx, {
                type: 'line', // Usamos Area chart
                data: {
                    labels: years,
                    datasets: [{
                        label: 'Emisiones GEI (Millones tCO₂e)',
                        data: emisionesTotales,
                        borderColor: '#c0392b', // Rojo oscuro
                        backgroundColor: 'rgba(192, 57, 43, 0.2)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.3,
                        pointRadius: 3,
                        pointHitRadius: 20
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    scales: { y: { title: { display: true, text: 'Millones Toneladas CO₂e' } } }
                }
            });

            // Cálculo de Evolución
            const start = emisionesTotales[0];
            const end = emisionesTotales[emisionesTotales.length - 1];
            const pct = ((end - start) / start) * 100;
            const sign = pct >= 0 ? '+' : '';

            document.getElementById('emissionsInfo').innerHTML = `
                <h4>Evolución al 2024</h4>
                <p>Las emisiones totales del SEN pasaron de <strong>${start.toFixed(1)}</strong> Millones de tCO₂e en 2010 a <strong>${end.toFixed(1)}</strong> Millones en 2024.</p>
                <p>Esto representa una variación del <span class="highlight">${sign}${pct.toFixed(1)}%</span> en el periodo.</p>
            `;
        }

        // C. Gráfica Emisiones Evitadas
        function initAvoidedChart() {
            const ctx = document.getElementById('chartAvoided');
            new Chart(ctx, {
                type: 'bar', // Barra se ve mejor para "ahorro"
                data: {
                    labels: years,
                    datasets: [{
                        label: 'Emisiones Evitadas (Millones tCO₂e)',
                        data: emisionesEvitadas,
                        backgroundColor: 'rgba(39, 174, 96, 0.6)', // Verde
                        borderColor: '#27ae60',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    scales: { y: { title: { display: true, text: 'Millones Toneladas CO₂e' } } }
                }
            });

            // Dato 2024 en texto
            document.getElementById('valAvoided24').innerText = emisionesEvitadas[emisionesEvitadas.length - 1].toFixed(2);
        }

        // Inicialización
        window.onload = function() {
            initFactorChart();
            initEmissionsChart();
            initAvoidedChart();

            // Botones Toggle Factor
            const btnChart = document.getElementById('btnFactorChart');
            const btnTable = document.getElementById('btnFactorTable');
            const divChart = document.getElementById('factorChartContainer');
            const divTable = document.getElementById('factorTableContainer');

            btnChart.onclick = () => { divChart.style.display=''; divTable.style.display='none'; btnChart.classList.add('primary'); btnTable.classList.remove('primary'); };
            btnTable.onclick = () => { divChart.style.display='none'; divTable.style.display=''; btnTable.classList.add('primary'); btnChart.classList.remove('primary'); };
        };
    </script>
</body>
</html>
